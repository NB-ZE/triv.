let apiURL="https://opentdb.com/api.php?amount=1",pexel="https://api.pexels.com/v1/search?query=",score=0,purchase1=!1,purchase2=!1,purchase3=!1,deferredPrompt;function rng(e){return Math.floor(Math.random()*e)}async function findquestions(){document.getElementById("main").innerHTML="",document.getElementById("getquestionbutton").disabled=!0;try{let e=await fetch(apiURL),t=await e.json();console.log(t),5==t.response_code?(document.getElementById("main").innerHTML="Sorry! No questions available at the moment. Try again later.",document.getElementById("getquestionbutton").disabled=!1):(console.log(t.results),displayQuestions(t.results))}catch(n){console.error("Error fetching questions:",n)}}async function displayQuestions(e){let t=document.getElementById("main");for(let n in t.innerHTML="",e){console.log(n);let r=document.createElement("div"),o=1;r.id="box"+n,!0===purchase1&&("easy"===e[n].difficulty&&(o=2),"medium"===e[n].difficulty&&(o=3),"hard"===e[n].difficulty&&(o=4)),void 0!=e[n].incorrect_answers[2]?(0===(random=rng(4))&&(r.innerHTML=`<div id="quiz"><p>${e[n].question}</p><br><p>Difficulty: ${e[n].difficulty}</p><br><div id="grid"><button onclick="correct(${o})">${e[n].correct_answer}</button><button onclick="wrong()">${e[n].incorrect_answers[0]}</button><button onclick="wrong()">${e[n].incorrect_answers[1]}</button><button onclick="wrong()">${e[n].incorrect_answers[2]}</button></div></div>`),1===random&&(r.innerHTML=`<div id="quiz"><p>${e[n].question}</p><br><p>Difficulty: ${e[n].difficulty}</p><br><div id="grid"><button onclick="wrong()">${e[n].incorrect_answers[0]}</button><button onclick="correct(${o})">${e[n].correct_answer}</button><button onclick="wrong()">${e[n].incorrect_answers[1]}</button><button onclick="wrong()">${e[n].incorrect_answers[2]}</button></div></div>`),2===random&&(r.innerHTML=`<div id="quiz"><p>${e[n].question}</p><br><p>Difficulty: ${e[n].difficulty}</p><br><div id="grid"><button onclick="wrong()">${e[n].incorrect_answers[0]}</button><button onclick="wrong()">${e[n].incorrect_answers[1]}</button><button onclick="correct(${o})">${e[n].correct_answer}</button><button onclick="wrong()">${e[n].incorrect_answers[2]}</button></div></div>`),3===random&&(r.innerHTML=`<div id="quiz"><p>${e[n].question}</p><br><p>Difficulty: ${e[n].difficulty}</p><br><div id="grid"><button onclick="wrong()">${e[n].incorrect_answers[0]}</button><button onclick="wrong()">${e[n].incorrect_answers[1]}</button><button onclick="wrong()">${e[n].incorrect_answers[2]}</button><button onclick="correct(${o})">${e[n].correct_answer}</button></div></div>`)):(0===(random=rng(2))&&(r.innerHTML=`<div id="quiz"><p id="question">${e[n].question}</p><br><p id="difficulty">Difficulty: ${e[n].difficulty}</p><br><div id="grid"><button onclick="correct(${o})">${e[n].correct_answer}</button><button onclick="wrong()">${e[n].incorrect_answers[0]}</button></div></div>`),1===random&&(r.innerHTML=`<div id="quiz"><p>${e[n].question}</p><br><p>Difficulty: ${e[n].difficulty}</p><br><div id="grid"><button onclick="wrong()">${e[n].incorrect_answers[0]}</button><button onclick="correct(${o})">${e[n].correct_answer}</button></div></div>`)),console.log(o);let i=e[n].question.replaceAll(" ","%20");try{let c=await fetch(pexel+i+"&per_page=1",{method:"GET",headers:{Accept:"application/json",Authorization:"1wPhkBHm5x0Y2SvgmlpWkTNb8KI9cJ5UoXSC2egNIcCPq8GgKsRIJUMk"}}),s=await c.json();console.log(s),console.log(s.photos[0].src.large2x);let l=document.createElement("div");l.id="boximg"+n,l.innerHTML=`<img src=${s.photos[0].src.large2x} alt="quiz image" id="imgae">`,t.appendChild(l)}catch(d){console.error("Error fetching img:",d)}t.appendChild(r)}}async function correct(e){let t=document.getElementById("score"),n=rng(3)+1;!0===purchase2&&9===rng(10)&&(e+=e),!0===purchase3&&(e+=e),score+=e,t.innerHTML="SCORE: "+score;let r=document.getElementById("main");r.innerHTML=`<h1>Correct!</h1><audio autoplay><source src="correct${n}.mp3" type="audio/mpeg"></audio>`,document.getElementById("getquestionbutton").disabled=!1}async function wrong(){let e=document.getElementById("score"),t=rng(3)+1;score--,e.innerHTML="SCORE: "+score;let n=document.getElementById("main");n.innerHTML=`<h1>WRONG!!!</h1><audio autoplay><source src="wrong${t}.mp3" type="audio/mpeg"></audio>`,document.getElementById("getquestionbutton").disabled=!1}function openstore(){document.getElementById("lightbox").style.display="block"}function closestore(){document.getElementById("lightbox").style.display="none"}function purchase(e){let t=document.getElementById("buy1"),n=document.getElementById("buy2"),r=document.getElementById("buy3"),o=document.getElementById("score");1==e&&score>=5&&(t.disabled=!0,t.innerHTML="Purchased!",purchase1=!0,score-=5,o.innerHTML="SCORE: "+score),2==e&&score>=15&&(n.disabled=!0,n.innerHTML="Purchased!",purchase2=!0,score-=15,o.innerHTML="SCORE: "+score),3==e&&score>=50&&(r.disabled=!0,r.innerHTML="Purchased!",purchase3=!0,score-=50,o.innerHTML="SCORE: "+score)}"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("sw.js").then(function(e){console.log("Service Worker registered with scope:",e.scope)},function(e){console.log("Service Worker registration failed:",e)})}),console.log(window.isSecureContext),window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),deferredPrompt=e;let t=document.getElementById("installButton");console.log("Johnson"),t.style.display="block",t.addEventListener("click",()=>{t.style.display="none",deferredPrompt.prompt(),deferredPrompt.userChoice.then(e=>{"accepted"===e.outcome?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt"),deferredPrompt=null})})}),window.onload=function(){closestore(),document.getElementById("lightbox").onclick=function(){closestore()}};